<?xml version="1.0" encoding="UTF-8"?>
<check_def check="icmp">
    <descr>Check host presence using ICMP echo request</descr>
    <probe_class>CheckICMP</probe_class>
    <flags_def>
        <flag_info>
            <name>host</name>
            <usage>Host target as ip version 4/6 or hostname</usage>
            <default></default>
            <role>mandatory</role>
            <type>string</type>
            <hint>Host or IP</hint>
        </flag_info>
        <flag_info>
            <name>pkts_number</name>
            <usage>Number of packets to send</usage>
            <default>5</default>
            <role>optional</role>
            <type>int</type>
            <hint>Packets number</hint>
        </flag_info>
        <flag_info>
            <name>pkts_size</name>
            <usage>Size of the ICMP body in octets</usage>
            <default>56</default>
            <role>optional</role>
            <type>int</type>
            <hint>Octets</hint>
        </flag_info>
        <flag_info>
            <name>pl_warning</name>
            <usage>Packet lost "CRITICAL" threshold in percent. Will return a status "WARNING" when packet lost exceed the value</usage>
            <default>50</default>
            <role>optional</role>
            <type>int</type>
            <hint>Milliseconds</hint>
        </flag_info>
        <flag_info>
            <name>pl_critical</name>
            <usage>Packet lost "CRITICAL" threshold in percent. Will return a status "CRITICAL" when packet lost exceed the value</usage>
            <default>100</default>
            <role>optional</role>
            <type>int</type>
            <hint>Milliseconds</hint>
        </flag_info>
        <flag_info>
            <name>ms_warning</name>
            <usage>Echo/Reply latency "WARNING" threshold. Will return a status "WARNING" if average reply time exceed the value</usage>
            <default>200</default>
            <role>optional</role>
            <type>int</type>
            <hint>Milliseconds</hint>
        </flag_info>
        <flag_info>
            <name>ms_critical</name>
            <usage>Echo/Reply latency "CRITICAL" threshold. Will return a status "CRITICAL" if average reply time exceed the value</usage>
            <default>2500</default>
            <role>optional</role>
            <type>int</type>
            <hint>Milliseconds</hint>
        </flag_info>
        <flag_info>
            <name>ms_timeout</name>
            <usage>Stop waiting reply or refuse reply when it exceed the value</usage>
            <default>5000</default>
            <role>optional</role>
            <type>int</type>
            <hint>Milliseconds</hint>
        </flag_info>
        <flag_info>
            <name>ms_interval</name>
            <usage>Interval in milliseconds between request packets</usage>
            <default>100</default>
            <role>optional</role>
            <type>int</type>
            <hint>Milliseconds</hint>
        </flag_info>
       <flag_info>
            <name>useIpv6</name>
            <usage>Force use of the v6 address. Usefull if "host" arg is an hostname</usage>
            <default>false</default>
            <role>optional</role>
            <type>bool</type>
            <hint></hint>
        </flag_info>
    </flags_def>
    <performances>
        <!--
            In this example, the probe return record should have these properties for errd4j to log
            corectly:
            #probe_return.perf_return = 
                [
                    {"PercentLost",      x},
                    {"MinRoundTrip",     x},
                    {"MaxRoundTrip",     x},
                    {"AverageRoundTrip", x}
                ]
        -->
        <data_sources>
            <ds>
                <dsName>MinRoundTrip</dsName>
                <dsType>GAUGE</dsType>
            </ds>
            <ds>
                <dsName>MaxRoundTrip</dsName>
                <dsType>GAUGE</dsType>
            </ds>
            <ds>
                <dsName>AverageRoundTrip</dsName>
                <dsType>GAUGE</dsType>
            </ds>
            <ds>
                <dsName>PercentLost</dsName>
                <dsType>GAUGE</dsType>
            </ds>
        </data_sources>
        <graphs>
            <graph_desc>
                <graphName>ICMPPerfs</graphName>
                <graphTitle>ICMP performances</graphTitle>
                <verticalLabel>Milliseconds</verticalLabel>
                <min>0</min>
                <max>undefined</max>
                <rigid>false</rigid>
                <base>1000</base>
                <unit>ms</unit>
                <unitExponent>0</unitExponent>
                <add>
                    <name>MaxRoundTrip</name>
                    <graphType>area</graphType>
                    <legend>Max round trip</legend>
                    <consolFun>MAX</consolFun>
                    <color>#204A87AA</color>
                </add>
                <add>
                    <name>AverageRoundTrip</name>
                    <graphType>line</graphType>
                    <legend>Average round trip</legend>
                    <consolFun>AVERAGE</consolFun>
                    <color>#729FCFFF</color>
                </add>
                <add>
                    <name>MinRoundTrip</name>
                    <graphType>area</graphType>
                    <legend>Min round trip</legend>
                    <consolFun>MIN</consolFun>
                    <color>#3465A4AA</color>
                </add>
            </graph_desc>
            <graph_desc>
                <graphName>ICMPPercentsLost</graphName>
                <graphTitle>ICMP echo/replies lost</graphTitle>
                <verticalLabel>Percent</verticalLabel>
                <min>0</min>
                <max>100</max>
                <rigid>true</rigid>
                <base>1000</base>
                <unit>%</unit>
                <unitExponent>0</unitExponent>
                <add>
                    <name>PercentLost</name>
                    <graphType>area</graphType>
                    <legend>Maximum Percent packets lost</legend>
                    <consolFun>MAX</consolFun>
                    <color>#AD7FA8FF</color>
                </add>
                <add>
                    <name>PercentLost</name>
                    <graphType>line</graphType>
                    <legend>Average Percent packets lost</legend>
                    <consolFun>AVERAGE</consolFun>
                    <color>#5C3566FF</color>
                </add>

            </graph_desc>
        </graphs>
    </performances>
</check_def>
