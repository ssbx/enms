
snmpman:register_element(
    "testTarget0",
    [
        {ip_address, "192.168.0.5"},
        {snmp_version, "3"},
        {security_level, "authPriv"},
        {security_name, "asterix"},
        {auth_proto, "SHA"},
        {auth_key, "password123"},
        {priv_proto, "AES"},
        {priv_key, "enckey123"}
    ]).

snmpman:get("testTarget0", [
    "1.3.6.1.2.1.1.1.0",
    "1.3.6.1.2.1.1.4.0"
    ]).

snmpman:register_element(
    "testTarget1",
    [
        {ip_address, "192.168.0.5"},
        {snmp_version, "3"},
        {security_level, "authPriv"},
        {security_name, "asterix"},
        {auth_proto, "SHA"},
        {auth_key, "password123"},
        {priv_proto, "AES"},
        {priv_key, "enckey123"}
    ]).

snmpman:get("testTarget1", [
    "1.3.6.1.2.1.1.1.0",
    "1.3.6.1.2.1.1.4.0"
    ]).

snmpman:unregister_element("testTarget0").
snmpman:get("testTarget1", [
    "1.3.6.1.2.1.1.1.0",
    "1.3.6.1.2.1.1.4.0"
    ]).



snmpman:register_element(
    "testTarget2",
    [
        {ip_address,"192.168.0.5"},
        {snmp_version,"3"},
        {security_level,"authPriv"},
        {security_name,"asterix"},
        {auth_proto,"SHA"},
        {auth_key,"password123"},
        {priv_proto,"AES"},
        {priv_key,"enckey123"},
        {engine_id,"800075CB801CA24C9954318517"}

        %{ip_version,"v4"},
        %{timeout,2500},
        %{port,161},
        %{community,"undefined"},
        %{retries,1},
    ]).

snmpman:get("testTarget2", [
    "1.3.6.1.2.1.1.1.0",
    "1.3.6.1.2.1.1.4.0"
    ]).

snmpman:walk_tree("testTarget", "1.3.6.1.2.1.1").

snmpman:walk_table("testTarget", [
"1.3.6.1.2.1.2.2.1.2",
"1.3.6.1.2.1.2.2.1.3",
"1.3.6.1.2.1.2.2.1.4",
"1.3.6.1.2.1.2.2.1.5",
"1.3.6.1.2.1.2.2.1.6",
"1.3.6.1.2.1.2.2.1.7",
"1.3.6.1.2.1.2.2.1.8",
"1.3.6.1.2.1.2.2.1.9",
"1.3.6.1.2.1.2.2.1.10"
]).

snmpman:which_elements().
snmpman:which_usm_users().

snmpman:unregister_element("testTarget").

snmpman:which_elements().
snmpman:which_usm_users().

%% ces config minimales doivent fonctionner
%% 1/2c:
snmpman:register_element(
    "testTarget",
    [
        {ip_address, "192.168.0.5"},
        {snmp_version, "2c"},
        {community, "public"}
    ]).

3 authPriv:
snmpman:register_element(
    "testTarget3",
    [
        {ip_address, "192.168.0.5"},
        {snmp_version, "3"},
        {security_level, "authPriv"},
        {security_name, "asterix"},
        {auth_proto, "SHA"},
        {auth_key, "password123"},
        {priv_proto, "AES"},
        {priv_key, "enckey123"},
        {engine_id, EID}
    ]).

3 authNoPriv:
snmpman:register_element(
    "testTarget4",
    [
        {ip_address, "192.168.0.5"},
        {snmp_version, "3"},
        {security_level, "authNoPriv"},
        {security_name, "obelix"},
        {auth_proto, "MD5"},
        {auth_key, "password123"},
        {engine_id, EID}
    ]).

3 noAuthNoPriv:
snmpman:register_element(
    "testTarget5",
    [
        {ip_address, "192.168.0.5"},
        {snmp_version, "3"},
        {security_level, "noAuthNoPriv"},
        {security_name, "idefix"},
        {engine_id, EID}
    ]).
